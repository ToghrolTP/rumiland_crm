{% extends "base.html" %} {% block title %}ویرایش {{ customer.full_name }}{%
endblock %} {% block content %}
<div class="page-header">
    <div class="page-title">
        <h1>ویرایش مشتری</h1>
        <span class="badge badge-info">#{{ customer.id }}</span>
    </div>
</div>

<div class="card">
    <form method="POST" action="/edit/{{ customer.id }}">
        <div class="form-group">
            <label for="full_name" class="form-label">نام کامل *</label>
            <input
                type="text"
                id="full_name"
                name="full_name"
                class="form-input"
                value="{{ customer.full_name }}"
                required
                autofocus
            />
        </div>

        <div class="form-group">
            <label for="company" class="form-label">شرکت *</label>
            <input
                type="text"
                id="company"
                name="company"
                class="form-input"
                value="{{ customer.company }}"
                required
            />
        </div>

        <div class="form-group">
            <label for="email" class="form-label">
ایمیل
                <span class="form-label-badge" id="email-status"></span>
            </label>
            <input
                type="email"
                id="email"
                name="email"
                class="form-input"
                value="{{ customer.email }}"
                autocomplete="email"
                spellcheck="false"
            />
            <p class="form-hint">
                آدرس ایمیل باید شامل @ و نام دامنه باشد (مثال: info@sherkat.com)
            </p>
            <p class="form-hint keyboard-hint">
                💡 نکته: ایمیل را با کیبورد انگلیسی تایپ کنید
            </p>
            <p class="form-error" id="email-error" style="display: none">
                فرمت ایمیل نادرست است
            </p>
            <div
                id="email-suggestions"
                class="email-suggestions"
                style="display: none"
            >
                <p class="suggestion-label">آیا منظورتان این است؟</p>
                <button
                    type="button"
                    class="suggestion-btn"
                    id="email-suggestion"
                ></button>
            </div>
        </div>

        <div class="form-group">
            <label for="phone_number" class="form-label">
                شماره تلفن *
                <span class="form-label-badge" id="phone-status"></span>
            </label>
            <input
                type="tel"
                id="phone_number"
                name="phone_number"
                class="form-input"
                value="{{ customer.phone_number }}"
                placeholder="0912 345 6789"
                maxlength="14"
                required
            />
            <p class="form-hint">
                شماره موبایل (مثال: 0912 345 6789) یا تلفن ثابت (مثال: 021 8844
                5566) را وارد کنید
            </p>
            <details class="form-details">
                <summary>راهنمای کدهای شهرها</summary>
                <div class="area-codes">
                    <span>تهران: 021</span>
                    <span>کرج: 026</span>
                    <span>اصفهان: 031</span>
                    <span>تبریز: 041</span>
                    <span>مشهد: 051</span>
                    <span>شیراز: 071</span>
                    <span>اهواز: 061</span>
                </div>
            </details>
            <p class="form-error" id="phone-error" style="display: none">
                شماره تلفن نامعتبر است
            </p>
        </div>
        
        <div class="form-group">
            <label for="sales_count" class="form-label">تعداد فروش</label>
            <input
                type="number"
                id="sales_count"
                name="sales_count"
                class="form-input"
                value="{{ customer.sales_count }}"
                min="0" required>
        </div>

        <div class="form-group">
            <label for="job_title" class="form-label">سمت شغلی</label>
            <input
                type="text"
                id="job_title"
                name="job_title"
                class="form-input"
                value="{{ customer.job_title }}"
            />
        </div>
        
        <div class="form-group">
            <label for="city" class="form-label">شهر</label>
            <select name="city" id="city" class="form-input">
                <option value="" {% if customer.city.is_empty() %}selected{% endif %}>انتخاب کنید</option>
                {% for city_option in cities %}
                    <option value="{{ city_option.as_str() }}" {% if customer.city == city_option.as_str() %}selected{% endif %}>
                        {{ city_option.display_name() }}
                    </option>
                {% endfor %}
            </select>
        </div>
        
        <div class="form-group">
            <label for="address" class="form-lable">آدرس</label>
            <input type="text" id="address" name="address" class="form-input" value="{{ customer.address }}">
        </div>

        <div class="form-group">
            <label for="notes" class="form-label">یادداشت‌ها</label>
            <textarea id="notes" name="notes" class="form-textarea">
{{ customer.notes }}</textarea
            >
        </div>

        <div
            class="form-group"
            style="
                display: flex;
                gap: var(--space-sm);
                margin-top: var(--space-xl);
            "
        >
            <button
                type="submit"
                class="btn btn-primary btn-lg"
                style="flex: 1"
                id="submit-btn"
            >
                <span class="btn-content">
                    <span class="btn-icon">💾</span>
                    <span class="btn-text">ذخیره تغییرات</span>
                </span>
                <span class="btn-loading" style="display: none">
                    <span class="spinner"></span>
                    <span>در حال ذخیره...</span>
                </span>
            </button>
            <a
                href="/customer/{{ customer.id }}"
                class="btn btn-ghost btn-lg"
                id="cancel-btn"
            >
                انصراف
            </a>
        </div>
    </form>

    <div class="form-overlay" id="form-overlay" style="display: none">
        <div class="overlay-content">
            <div class="spinner-large"></div>
            <p>در حال به‌روزرسانی اطلاعات...</p>
        </div>
    </div>
</div>

<script src="/static/js/customer-form.js" type="text/javascript"></script>
{% endblock %}